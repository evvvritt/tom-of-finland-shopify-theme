var app={};app._body=$("body"),app.utils={randomIntegerBt:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},shuffleArray:function(t){for(var e=t.length-1;e>0;e--){var o=Math.floor(Math.random()*(e+1)),a=t[e];t[e]=t[o],t[o]=a}return t}},app.artGrid={_grid:$(".art-grid"),_item:$(".art-grid").children(".grid__item"),_widths:["two-twelfths","three-twelfths","three-twelfths","four-twelfths","four-twelfths","four-twelfths","four-twelfths","five-twelfths"],_minWinWidth:768,resizeItem:function(t){var e=app.artGrid._widths;t.removeClass("large--one-quarter").addClass(function(){return"large--"+e[app.utils.randomIntegerBt(0,e.length-1)]})},showItems:function(t){t="undefined"==typeof t,this._grid.find(".grid__item").toggleClass("visible",t)},layout:function(t,e){var o="undefined"==typeof t?this._grid:t,a=o.find(".grid__item");o.length>0&&o.imagesLoaded(function(){a.each(function(){app.artGrid.resizeItem($(this))});var t=window.shuffle;new t(o,{itemSelector:".grid__item",sizer:".art-grid--sizer",initialSort:{randomize:!0}}),app.artGrid.showItems(),"function"==typeof e&&e()})},remove:function(){this._grid.removeClass("art-grid--enabled").addClass("grid-uniform"),this._items.removeAttr("style"),this.showItems()}},app.lbox=function(){var t=$("#lightbox"),e=$("body"),o=function(){e.removeClass("lightbox-visible")};$(document).on("click","[data-lbox]",function(){var o=$(window).width()<=768,a=o?$(this).attr("data-lbox-m"):$(this).attr("data-lbox");e.addClass("lightbox-visible"),t.find(".content").css("background-image","url("+a+")").html('<img src="'+a+'" >'),t.toggleClass("img-can-overflow",o)}),$(document).on("click","a.product-single__thumbnail",function(){$("#featuredImgLink").attr("data-lbox",$(this).data("lbox-asset")).attr("data-lbox-m",$(this).data("lbox-m-asset"))}),$(document).on("click","#lightbox .content",function(){if(t.hasClass("img-can-overflow"))t.removeClass("img-can-overflow").scrollTop(0);else{t.addClass("img-can-overflow");var e=t.find(".content").outerHeight()-t.height(),o=t.find(".content").outerWidth()-t.width();t.scrollTop(e/2).scrollLeft(o/2)}}),$(document).on("click","#closeLightboxBtn",o),$(document).on("keydown",function(t){27===t.keyCode&&o()})},app.colorBar=function(t){t="undefined"==typeof t?$(window).scrollTop():t,t+$(window).height()<$("#colorBarStatic").offset().top?app._body.addClass("colorbar-fixed"):app._body.removeClass("colorbar-fixed")},app.applyAppClasses=function(){var t=window.location.pathname;0===t.indexOf("/apps/")&&t.split("/").length>=3&&app._body.addClass("template-app-"+t.split("/")[2])},app.over18check=function(){var t=$("#overlay18Plus");if(t.length>0){var e=sessionStorage.getItem("over18");console.log("over 18?: "+e),null!==e&&"true"===e||t.removeClass("visually-hidden"),$(document).on("click","#confirmOver18",function(){sessionStorage.setItem("over18",!0),t.addClass("visually-hidden")}),$(document).on("click","#denyOver18",function(){sessionStorage.setItem("over18",!1),t.attr("data-state","locked")})}},app.searchBar=function(){$(document).on("click",".site-header__search-bar-toggle",function(){$("#headerSearchBar").toggle().find('input[type="search"]').focus()})},app.infiniteScroll={loading:!1,nextPageUrl:$(".pagination .next a").attr("href"),onScroll:function(t){sessionStorage.dev&&this.nextPageUrl&&!this.loading&&$(window).width()>=768&&t+$(window).height()>=$(document).height()-$(window).height()/4&&(this.loading=!0,$.ajax({url:this.nextPageUrl,success:function(t){var e=$(t).find(".pagination");e?($(".pagination").replaceWith(e),app.infiniteScroll.nextPageUrl=e.find(".next a").attr("href")):$(".pagination").remove();var o=$(t).find(".ajax-container"),a=$(".ajax-container").last();a.after(o),a.hasClass("art-grid")?app.artGrid.layout(o,function(){app.infiniteScroll.loading=!1}):app.infiniteScroll.loading=!1}}))}},app.scrollHandler=function(){var t=$(window).scrollTop();app.colorBar(t),app.infiniteScroll.onScroll(t)},$(function(){app.artGrid.layout(),app.colorBar(),app.over18check(),app.lbox(),app.searchBar(),app.applyAppClasses(),$(window).scroll(app.scrollHandler),console.log("dev?:"+sessionStorage.dev)});