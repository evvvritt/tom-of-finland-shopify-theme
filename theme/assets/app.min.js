var app={};app._body=$("body"),app.utils={randomIntegerBt:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},shuffleArray:function(t){for(var e=t.length-1;e>0;e--){var a=Math.floor(Math.random()*(e+1)),o=t[e];t[e]=t[a],t[a]=o}return t}},app.artGrid={_grid:$(".art-grid"),_item:$(".art-grid").children(".grid__item"),_widths:["two-twelfths","three-twelfths","three-twelfths","four-twelfths","four-twelfths","four-twelfths","four-twelfths","five-twelfths"],_minWinWidth:768,_shuffle:null,resizeItem:function(t){var e=app.artGrid._widths;t.removeClass("large--one-quarter").addClass(function(){return"large--"+e[app.utils.randomIntegerBt(0,e.length-1)]})},showItems:function(t){t="undefined"==typeof t,$(".art-grid").find(".grid__item").toggleClass("visible",t)},layout:function(t,e){var a="undefined"==typeof t?this._grid:t,o=a.find(".grid__item");a.length>0&&a.imagesLoaded(function(){o.each(function(){app.artGrid.resizeItem($(this))});var t=window.shuffle;app.artGrid._shuffle=new t(a,{itemSelector:".grid__item",sizer:".art-grid--sizer",initialSort:{randomize:!0}}),app.artGrid.showItems(),"function"==typeof e&&e()})},remove:function(){this._grid.removeClass("art-grid--enabled").addClass("grid-uniform"),this._items.removeAttr("style"),this.showItems()}},app.lbox=function(){var t=$("#lightbox"),e=$("body"),a=function(){e.removeClass("lightbox-visible")};$(document).on("click","[data-lbox]",function(){var a=$(window).width()<=768,o=a?$(this).attr("data-lbox-m"):$(this).attr("data-lbox");e.addClass("lightbox-visible"),t.find(".content").css("background-image","url("+o+")").html('<img src="'+o+'" >'),t.toggleClass("img-can-overflow",a)}),$(document).on("click","a.product-single__thumbnail",function(){$("#featuredImgLink").attr("data-lbox",$(this).data("lbox-asset")).attr("data-lbox-m",$(this).data("lbox-m-asset"))}),$(document).on("click","#lightbox .content",function(){if(t.hasClass("img-can-overflow"))t.removeClass("img-can-overflow").scrollTop(0);else{t.addClass("img-can-overflow");var e=t.find(".content").outerHeight()-t.height(),a=t.find(".content").outerWidth()-t.width();t.scrollTop(e/2).scrollLeft(a/2)}}),$(document).on("click","#closeLightboxBtn",a),$(document).on("keydown",function(t){27===t.keyCode&&a()})},app.colorBar=function(t){t="undefined"==typeof t?$(window).scrollTop():t,t+$(window).height()<$("#colorBarStatic").offset().top?app._body.addClass("colorbar-fixed"):app._body.removeClass("colorbar-fixed")},app.applyAppClasses=function(){var t=window.location.pathname;0===t.indexOf("/apps/")&&t.split("/").length>=3&&app._body.addClass("template-app-"+t.split("/")[2])},app.over18check=function(){var t=$("#overlay18Plus");if(t.length>0){var e=sessionStorage.getItem("over18");console.log("over 18?: "+e),null!==e&&"true"===e||t.removeClass("visually-hidden"),$(document).on("click","#confirmOver18",function(){sessionStorage.setItem("over18",!0),t.addClass("visually-hidden")}),$(document).on("click","#denyOver18",function(){sessionStorage.setItem("over18",!1),t.attr("data-state","locked")})}},app.searchBar=function(){$(document).on("click",".site-header__search-bar-toggle",function(){$("#headerSearchBar").toggle().find('input[type="search"]').focus()})},app.infiniteScroll={loading:!1,nextPageUrl:$(".pagination .next a").attr("href"),onScroll:function(t){this.nextPageUrl&&!this.loading&&$(window).width()>=768&&t+$(window).height()>=$(document).height()-$(window).height()/4&&(this.loading=!0,$.ajax({url:this.nextPageUrl,success:function(t){var e=$(t).find(".pagination");e?($(".pagination").replaceWith(e),app.infiniteScroll.nextPageUrl=e.find(".next a").attr("href")):$(".pagination").remove();var a=$(t).find(".ajax-container"),o=$(".ajax-container").last();o.after(a),o.hasClass("art-grid")?app.artGrid.layout(a,function(){app.infiniteScroll.loading=!1}):app.infiniteScroll.loading=!1}}))}},app.scrollHandler=function(){var t=$(window).scrollTop();app.colorBar(t),app.infiniteScroll.onScroll(t)},$(function(){app.artGrid.layout(),app.colorBar(),app.over18check(),app.lbox(),app.searchBar(),app.applyAppClasses(),$(window).scroll(app.scrollHandler),console.log("dev?:"+sessionStorage.dev)});